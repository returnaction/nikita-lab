version: '3.8'  # –í–µ—Ä—Å–∏—è —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ docker-compose

services:
  # ‚úÖ –°–µ—Ä–≤–∏—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö MySQL
  mysql:
    image: mysql:8                         # –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ MySQL —Å Docker Hub
    container_name: mysql                  # –ò–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
    environment:
      MYSQL_ROOT_PASSWORD: root            # –ü–∞—Ä–æ–ª—å –¥–ª—è root-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      MYSQL_DATABASE: userdb               # –ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—É—é —Å–æ–∑–¥–∞—Å—Ç MySQL
      MYSQL_USER: user                     # –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      MYSQL_PASSWORD: user                 # –ü–∞—Ä–æ–ª—å –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    ports:
      - "3307:3306"                        # –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–æ—Ä—Ç: host 3307 ‚Üí –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä 3306
    networks:
      - net                                # –ü–æ–¥–∫–ª—é—á–∞–µ–º –∫ –æ–±—â–µ–π —Å–µ—Ç–∏ "net"

  # ‚úÖ –°–µ—Ä–≤–∏—Å backend –Ω–∞ Spring Boot
  user-service:
    build:
      context: ./user-service              # –ü–∞–ø–∫–∞, –≥–¥–µ –ª–µ–∂–∏—Ç Dockerfile –∏ .jar
    container_name: user-service
    ports:
      - "8081:8081"                        # –ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–∞: host 8081 ‚Üí –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä 8081
    depends_on:
      - mysql                              # –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ mysql
    environment:
      SPRING_DATASOURCE_URL: jdbc:mysql://mysql:3306/userdb?createDatabaseIfNotExist=true
      SPRING_DATASOURCE_USERNAME: user
      SPRING_DATASOURCE_PASSWORD: user
    networks:
      - net

  # ‚úÖ Frontend –Ω–∞ Nginx —Å HTML + JS
  frontend:
    build:
      context: ./frontend                  # –ü–∞–ø–∫–∞ —Å index.html, default.conf –∏ Dockerfile
    container_name: frontend
    ports:
      - "80:80"                            # –ü—Ä–æ–±—Ä–æ—Å: localhost ‚Üí –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–π Nginx
    depends_on:
      - user-service                       # –ñ–¥—ë—Ç, –ø–æ–∫–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –±—ç–∫–µ–Ω–¥
    networks:
      - net

# üåê –û–±—â–∞—è —Å–µ—Ç—å, —á—Ç–æ–±—ã —Å–µ—Ä–≤–∏—Å—ã "–≤–∏–¥–µ–ª–∏" –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –ø–æ –∏–º–µ–Ω–∏
networks:
  net:
